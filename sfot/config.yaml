processing:
  frame_rate: 0.5 # 1 frame every 2 seconds
  queue_size: 100
  timeout: 1800 # 30 minutes max per chunk

detection:
  threshold: 0.78
  template_path: "templates/matchup_template.png"

# Emblem detection and removal configuration
emblem_detection:
  enabled: true
  method: "template" # Detection method: 'akaze' or 'template'
  template_method: "TM_CCOEFF_NORMED"
  akaze_threshold: 0.45 # AKAZE: real emblems >0.52, false positives <0.03
  template_threshold: 0.5 # Template matching: threshold for TM_CCOEFF_NORMED (was 0.70 for TM_SQDIFF_NORMED)
  templates_dir: "templates/"
  akaze_feature_resolution: "1080p" # Resolution to use for AKAZE feature extraction (only used when method='akaze')

# Right edge detection for partial occlusion handling
right_edge_detection:
  enabled: true
  threshold: 0.7
  templates_dir: "templates/"
  crop_margin_percent: 5

# OCR preprocessing for easyOCR
ocr_preprocessing:
  scale_factor: 3.0 # Upscale before preprocessing
  gaussian_blur: 2 # Gaussian blur kernel size (0 to disable)
  clahe_enabled: true # Enable CLAHE contrast enhancement
  clahe_clip: 1.4 # CLAHE clip limit
  clahe_grid: 11 # CLAHE tile grid size
  binary_threshold: 154 # Binary threshold value (0-255)
  invert: true # Invert black/white after binary threshold

resources:
  max_memory_mb: 512
  max_cpu_percent: 50

streamlink:
  default_stream: "480p"
  fallback_streams: ["360p", "worst"]
  retry_attempts: 3
  retry_delay: 5

ffmpeg:
  keyframes_only: true
  output_format: "mjpeg"
  loglevel: "warning"

easyocr:
  lang: ["en"]
  model_storage_directory: "./models" # Pre-download models here
  download_enabled: false
  confidence_threshold: 0.5 # Minimum confidence to accept
  paragraph: false # Expect single line text
  batch_size: 1

supabase:
  storage_bucket: "detections"
  batch_size: 10
  connection_timeout: 30
  retry_attempts: 3

logging:
  level: "INFO"
  format: "json"
  max_file_size_mb: 50
  backup_count: 3

test_mode:
  enabled: false # Override with TEST_MODE env var
  data_directory: "test_data"
  default_qualities: ["480p", "360p", "1080p60"]
