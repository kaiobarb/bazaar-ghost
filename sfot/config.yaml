processing:
  frame_rate: 0.2 # 1 frame every 5 seconds
  queue_size: 10
  timeout: 1800 # 30 minutes max per chunk
  batch_update_interval: 20 # Update Supabase every 20 seconds

detection:
  threshold: 0.78
  # Resolution-agnostic crop region as percentages of frame dimensions
  # Format: [x, y, width, height] where each value is 0.0-1.0
  # Converted from 480p pixel values: x=503/854, y=352/480, w=271/854, h=54/480
  crop_region_percent: [0.5726, 0.7333, 0.3500, 0.1125]
  template_path: "templates/matchup_template.png"

# Emblem detection and removal configuration
emblem_detection:
  enabled: true
  method: "template" # Detection method: 'akaze' or 'template'
  akaze_threshold: 0.45 # AKAZE: real emblems >0.52, false positives <0.03
  template_threshold: 0.70 # Template matching: real emblems ~0.93, false positives ~0.70
  templates_dir: "templates/"
  akaze_feature_resolution: "1080p" # Resolution to use for AKAZE feature extraction (only used when method='akaze')

# Right edge detection for partial occlusion handling
right_edge_detection:
  enabled: true
  threshold: 0.7
  templates_dir: "templates/"
  crop_margin_percent: 5

# OCR preprocessing based on tuned parameters
ocr_preprocessing:
  scale_factor: 3.0
  gaussian_blur: 2
  clahe_enabled: true
  clahe_clip: 1.4
  clahe_grid: 11
  binary_threshold: 154
  invert: true

resources:
  max_memory_mb: 512
  max_cpu_percent: 50

streamlink:
  default_stream: "480p"
  fallback_streams: ["360p", "worst"]
  retry_attempts: 3
  retry_delay: 5

ffmpeg:
  keyframes_only: true
  output_format: "mjpeg"
  loglevel: "warning"

tesseract:
  lang: "eng"
  config: "-c tessedit_char_whitelist=ABCDEFGHIJKLMNOPQRSTUVWXYZ_-.abcdefghijklmnopqrstuvwxyz0123456789 -c load_system_dawg=0 -c load_freq_dawg=0"
  psm: 8 # Single Word
  oem: 0 # Legacy performs waay better on the pre-processed frames
  dpi: 300
  timeout: 5

supabase:
  storage_bucket: "detections"
  batch_size: 10
  connection_timeout: 30
  retry_attempts: 3

logging:
  level: "INFO"
  format: "json"
  max_file_size_mb: 50
  backup_count: 3

test_mode:
  enabled: false # Override with TEST_MODE env var
  data_directory: "test_data"
  default_qualities: ["480p", "360p", "1080p60"]
